{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Bus_Tracking\\\\BackEnd\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Bus_Tracking\\\\BackEnd\",\"filename\":\"D:\\\\Bus_Tracking\\\\BackEnd\\\\src\\\\sever.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Bus_Tracking\\\\BackEnd\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.4:development":{"value":{"code":"import express from \"express\";\nimport bodyParser from \"body-parser\";\nimport viewEngine from \"./config/viewEngine.js\";\nimport initWebRouter from \"./route/web.js\"; // ✅ giờ import này hợp lệ\nimport connectDB from \"./config/connectDB.js\";\nimport cookieParser from \"cookie-parser\";\nimport helmet from \"helmet\";\nimport path from \"path\";\nimport cors from \"cors\";\nimport dotenv from \"dotenv\";\ndotenv.config();\nconst app = express();\nconst __dirname = path.resolve();\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\napp.use(bodyParser.json({\n  limit: \"50mb\"\n}));\napp.use(bodyParser.urlencoded({\n  extended: true,\n  limit: \"50mb\"\n}));\napp.use(cors({\n  origin: \"http://localhost:3000\",\n  credentials: true,\n  methods: [\"GET\", \"POST\", \"PUT\", \"DELETE\"],\n  allowedHeaders: [\"Content-Type\", \"Authorization\"]\n}));\napp.use(helmet());\napp.use(express.json());\napp.use(cookieParser());\nviewEngine(app);\ninitWebRouter(app);\nconnectDB(app);\nconst port = process.env.PORT || 6969;\napp.listen(port, () => {\n  console.log(`✅ Server đang chạy tại http://localhost:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwiYm9keVBhcnNlciIsInZpZXdFbmdpbmUiLCJpbml0V2ViUm91dGVyIiwiY29ubmVjdERCIiwiY29va2llUGFyc2VyIiwiaGVsbWV0IiwicGF0aCIsImNvcnMiLCJkb3RlbnYiLCJjb25maWciLCJhcHAiLCJfX2Rpcm5hbWUiLCJyZXNvbHZlIiwidXNlIiwic3RhdGljIiwiam9pbiIsImpzb24iLCJsaW1pdCIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsIm9yaWdpbiIsImNyZWRlbnRpYWxzIiwibWV0aG9kcyIsImFsbG93ZWRIZWFkZXJzIiwicG9ydCIsInByb2Nlc3MiLCJlbnYiLCJQT1JUIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiRDpcXEJ1c19UcmFja2luZ1xcQmFja0VuZFxcc3JjXFwiLCJzb3VyY2VzIjpbInNldmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCBib2R5UGFyc2VyIGZyb20gXCJib2R5LXBhcnNlclwiO1xyXG5pbXBvcnQgdmlld0VuZ2luZSBmcm9tIFwiLi9jb25maWcvdmlld0VuZ2luZS5qc1wiO1xyXG5pbXBvcnQgaW5pdFdlYlJvdXRlciBmcm9tIFwiLi9yb3V0ZS93ZWIuanNcIjsgICAvLyDinIUgZ2nhu50gaW1wb3J0IG7DoHkgaOG7o3AgbOG7h1xyXG5pbXBvcnQgY29ubmVjdERCIGZyb20gXCIuL2NvbmZpZy9jb25uZWN0REIuanNcIjtcclxuaW1wb3J0IGNvb2tpZVBhcnNlciBmcm9tIFwiY29va2llLXBhcnNlclwiO1xyXG5pbXBvcnQgaGVsbWV0IGZyb20gXCJoZWxtZXRcIjtcclxuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IGNvcnMgZnJvbSBcImNvcnNcIjtcclxuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XHJcblxyXG5kb3RlbnYuY29uZmlnKCk7XHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcbmNvbnN0IF9fZGlybmFtZSA9IHBhdGgucmVzb2x2ZSgpO1xyXG5cclxuYXBwLnVzZShcIi9wdWJsaWNcIiwgZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgXCJwdWJsaWNcIikpKTtcclxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oeyBsaW1pdDogXCI1MG1iXCIgfSkpO1xyXG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlLCBsaW1pdDogXCI1MG1iXCIgfSkpO1xyXG5hcHAudXNlKFxyXG4gIGNvcnMoe1xyXG4gICAgb3JpZ2luOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxyXG4gICAgY3JlZGVudGlhbHM6IHRydWUsXHJcbiAgICBtZXRob2RzOiBbXCJHRVRcIiwgXCJQT1NUXCIsIFwiUFVUXCIsIFwiREVMRVRFXCJdLFxyXG4gICAgYWxsb3dlZEhlYWRlcnM6IFtcIkNvbnRlbnQtVHlwZVwiLCBcIkF1dGhvcml6YXRpb25cIl0sXHJcbiAgfSlcclxuKTtcclxuYXBwLnVzZShoZWxtZXQoKSk7XHJcbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpO1xyXG5hcHAudXNlKGNvb2tpZVBhcnNlcigpKTtcclxuXHJcbnZpZXdFbmdpbmUoYXBwKTtcclxuaW5pdFdlYlJvdXRlcihhcHApO1xyXG5jb25uZWN0REIoYXBwKTtcclxuXHJcbmNvbnN0IHBvcnQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDY5Njk7XHJcbmFwcC5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGDinIUgU2VydmVyIMSRYW5nIGNo4bqheSB04bqhaSBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsT0FBTyxNQUFNLFNBQVM7QUFDN0IsT0FBT0MsVUFBVSxNQUFNLGFBQWE7QUFDcEMsT0FBT0MsVUFBVSxNQUFNLHdCQUF3QjtBQUMvQyxPQUFPQyxhQUFhLE1BQU0sZ0JBQWdCLENBQUMsQ0FBRztBQUM5QyxPQUFPQyxTQUFTLE1BQU0sdUJBQXVCO0FBQzdDLE9BQU9DLFlBQVksTUFBTSxlQUFlO0FBQ3hDLE9BQU9DLE1BQU0sTUFBTSxRQUFRO0FBQzNCLE9BQU9DLElBQUksTUFBTSxNQUFNO0FBQ3ZCLE9BQU9DLElBQUksTUFBTSxNQUFNO0FBQ3ZCLE9BQU9DLE1BQU0sTUFBTSxRQUFRO0FBRTNCQSxNQUFNLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBRWYsTUFBTUMsR0FBRyxHQUFHWCxPQUFPLENBQUMsQ0FBQztBQUNyQixNQUFNWSxTQUFTLEdBQUdMLElBQUksQ0FBQ00sT0FBTyxDQUFDLENBQUM7QUFFaENGLEdBQUcsQ0FBQ0csR0FBRyxDQUFDLFNBQVMsRUFBRWQsT0FBTyxDQUFDZSxNQUFNLENBQUNSLElBQUksQ0FBQ1MsSUFBSSxDQUFDSixTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUNsRUQsR0FBRyxDQUFDRyxHQUFHLENBQUNiLFVBQVUsQ0FBQ2dCLElBQUksQ0FBQztFQUFFQyxLQUFLLEVBQUU7QUFBTyxDQUFDLENBQUMsQ0FBQztBQUMzQ1AsR0FBRyxDQUFDRyxHQUFHLENBQUNiLFVBQVUsQ0FBQ2tCLFVBQVUsQ0FBQztFQUFFQyxRQUFRLEVBQUUsSUFBSTtFQUFFRixLQUFLLEVBQUU7QUFBTyxDQUFDLENBQUMsQ0FBQztBQUNqRVAsR0FBRyxDQUFDRyxHQUFHLENBQ0xOLElBQUksQ0FBQztFQUNIYSxNQUFNLEVBQUUsdUJBQXVCO0VBQy9CQyxXQUFXLEVBQUUsSUFBSTtFQUNqQkMsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDO0VBQ3pDQyxjQUFjLEVBQUUsQ0FBQyxjQUFjLEVBQUUsZUFBZTtBQUNsRCxDQUFDLENBQ0gsQ0FBQztBQUNEYixHQUFHLENBQUNHLEdBQUcsQ0FBQ1IsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqQkssR0FBRyxDQUFDRyxHQUFHLENBQUNkLE9BQU8sQ0FBQ2lCLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkJOLEdBQUcsQ0FBQ0csR0FBRyxDQUFDVCxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBRXZCSCxVQUFVLENBQUNTLEdBQUcsQ0FBQztBQUNmUixhQUFhLENBQUNRLEdBQUcsQ0FBQztBQUNsQlAsU0FBUyxDQUFDTyxHQUFHLENBQUM7QUFFZCxNQUFNYyxJQUFJLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxJQUFJLElBQUksSUFBSTtBQUNyQ2pCLEdBQUcsQ0FBQ2tCLE1BQU0sQ0FBQ0osSUFBSSxFQUFFLE1BQU07RUFDckJLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJDQUEyQ04sSUFBSSxFQUFFLENBQUM7QUFDaEUsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","bodyParser","viewEngine","initWebRouter","connectDB","cookieParser","helmet","path","cors","dotenv","config","app","__dirname","resolve","use","static","join","json","limit","urlencoded","extended","origin","credentials","methods","allowedHeaders","port","process","env","PORT","listen","console","log"],"sourceRoot":"D:\\Bus_Tracking\\BackEnd\\src\\","sources":["sever.js"],"sourcesContent":["import express from \"express\";\r\nimport bodyParser from \"body-parser\";\r\nimport viewEngine from \"./config/viewEngine.js\";\r\nimport initWebRouter from \"./route/web.js\";   // ✅ giờ import này hợp lệ\r\nimport connectDB from \"./config/connectDB.js\";\r\nimport cookieParser from \"cookie-parser\";\r\nimport helmet from \"helmet\";\r\nimport path from \"path\";\r\nimport cors from \"cors\";\r\nimport dotenv from \"dotenv\";\r\n\r\ndotenv.config();\r\n\r\nconst app = express();\r\nconst __dirname = path.resolve();\r\n\r\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\r\napp.use(bodyParser.json({ limit: \"50mb\" }));\r\napp.use(bodyParser.urlencoded({ extended: true, limit: \"50mb\" }));\r\napp.use(\r\n  cors({\r\n    origin: \"http://localhost:3000\",\r\n    credentials: true,\r\n    methods: [\"GET\", \"POST\", \"PUT\", \"DELETE\"],\r\n    allowedHeaders: [\"Content-Type\", \"Authorization\"],\r\n  })\r\n);\r\napp.use(helmet());\r\napp.use(express.json());\r\napp.use(cookieParser());\r\n\r\nviewEngine(app);\r\ninitWebRouter(app);\r\nconnectDB(app);\r\n\r\nconst port = process.env.PORT || 6969;\r\napp.listen(port, () => {\r\n  console.log(`✅ Server đang chạy tại http://localhost:${port}`);\r\n});\r\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,SAAS;AAC7B,OAAOC,UAAU,MAAM,aAAa;AACpC,OAAOC,UAAU,MAAM,wBAAwB;AAC/C,OAAOC,aAAa,MAAM,gBAAgB,CAAC,CAAG;AAC9C,OAAOC,SAAS,MAAM,uBAAuB;AAC7C,OAAOC,YAAY,MAAM,eAAe;AACxC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,QAAQ;AAE3BA,MAAM,CAACC,MAAM,CAAC,CAAC;AAEf,MAAMC,GAAG,GAAGX,OAAO,CAAC,CAAC;AACrB,MAAMY,SAAS,GAAGL,IAAI,CAACM,OAAO,CAAC,CAAC;AAEhCF,GAAG,CAACG,GAAG,CAAC,SAAS,EAAEd,OAAO,CAACe,MAAM,CAACR,IAAI,CAACS,IAAI,CAACJ,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AAClED,GAAG,CAACG,GAAG,CAACb,UAAU,CAACgB,IAAI,CAAC;EAAEC,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AAC3CP,GAAG,CAACG,GAAG,CAACb,UAAU,CAACkB,UAAU,CAAC;EAAEC,QAAQ,EAAE,IAAI;EAAEF,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AACjEP,GAAG,CAACG,GAAG,CACLN,IAAI,CAAC;EACHa,MAAM,EAAE,uBAAuB;EAC/BC,WAAW,EAAE,IAAI;EACjBC,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,CAAC;EACzCC,cAAc,EAAE,CAAC,cAAc,EAAE,eAAe;AAClD,CAAC,CACH,CAAC;AACDb,GAAG,CAACG,GAAG,CAACR,MAAM,CAAC,CAAC,CAAC;AACjBK,GAAG,CAACG,GAAG,CAACd,OAAO,CAACiB,IAAI,CAAC,CAAC,CAAC;AACvBN,GAAG,CAACG,GAAG,CAACT,YAAY,CAAC,CAAC,CAAC;AAEvBH,UAAU,CAACS,GAAG,CAAC;AACfR,aAAa,CAACQ,GAAG,CAAC;AAClBP,SAAS,CAACO,GAAG,CAAC;AAEd,MAAMc,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI,IAAI,IAAI;AACrCjB,GAAG,CAACkB,MAAM,CAACJ,IAAI,EAAE,MAAM;EACrBK,OAAO,CAACC,GAAG,CAAC,2CAA2CN,IAAI,EAAE,CAAC;AAChE,CAAC,CAAC","ignoreList":[]}},"mtime":1762260109194},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Bus_Tracking\\\\BackEnd\\\\src\\\\route\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Bus_Tracking\\\\BackEnd\",\"filename\":\"D:\\\\Bus_Tracking\\\\BackEnd\\\\src\\\\route\\\\web.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Bus_Tracking\\\\BackEnd\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.4:development":{"value":{"code":"im;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpbSJdLCJzb3VyY2VSb290IjoiRDpcXEJ1c19UcmFja2luZ1xcQmFja0VuZFxcc3JjXFxyb3V0ZVxcIiwic291cmNlcyI6WyJ3ZWIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW0iXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["im"],"sourceRoot":"D:\\Bus_Tracking\\BackEnd\\src\\route\\","sources":["web.js"],"sourcesContent":["im"],"mappings":"AAAAA,EAAE","ignoreList":[]}},"mtime":1762259997969},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\BackEnd\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\BackEnd\",\"filename\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\BackEnd\\\\src\\\\sever.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\BackEnd\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.4:development":{"value":{"code":"import express from \"express\";\nimport bodyParser from \"body-parser\";\nimport viewEngine from \"./config/viewEngine.js\";\nimport initWebRouter from \"./route/web.js\";\nimport initAPIRouter from \"./route/Api.js\";\nimport { checkConnection } from \"./config/connectDB.js\"; // Import hàm check\nimport cookieParser from \"cookie-parser\";\nimport helmet from \"helmet\";\nimport path from \"path\";\nimport cors from \"cors\";\nimport dotenv from \"dotenv\";\nimport { createServer } from 'http'; // ✅ Thêm HTTP server\nimport { initWebSocket } from \"./service/WebsocketService.js\"; // ✅ Thêm WS\n\ndotenv.config();\nawait checkConnection(); // ✅ Kiểm tra kết nối DB khi khởi động\n\nconst app = express();\nconst __dirname = path.resolve();\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\napp.use(bodyParser.json({\n  limit: \"50mb\"\n}));\napp.use(bodyParser.urlencoded({\n  extended: true,\n  limit: \"50mb\"\n}));\napp.use(cors({\n  origin: process.env.CORS_ORIGIN || \"http://localhost:5173\",\n  credentials: true\n}));\napp.use(helmet());\napp.use(express.json());\napp.use(cookieParser());\nviewEngine(app);\n\n// Khởi tạo các Router\ninitWebRouter(app);\ninitAPIRouter(app);\n\n// ✅ Cấu hình Server (HTTP + WebSocket)\nconst port = process.env.PORT || 6969;\nconst server = createServer(app); // Tạo HTTP server từ app Express\n\ninitWebSocket(server); // Khởi tạo WebSocket Server\n\nserver.listen(port, () => {\n  console.log(`✅ Server (HTTP & WS) đang chạy tại http://localhost:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwiYm9keVBhcnNlciIsInZpZXdFbmdpbmUiLCJpbml0V2ViUm91dGVyIiwiaW5pdEFQSVJvdXRlciIsImNoZWNrQ29ubmVjdGlvbiIsImNvb2tpZVBhcnNlciIsImhlbG1ldCIsInBhdGgiLCJjb3JzIiwiZG90ZW52IiwiY3JlYXRlU2VydmVyIiwiaW5pdFdlYlNvY2tldCIsImNvbmZpZyIsImFwcCIsIl9fZGlybmFtZSIsInJlc29sdmUiLCJ1c2UiLCJzdGF0aWMiLCJqb2luIiwianNvbiIsImxpbWl0IiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwib3JpZ2luIiwicHJvY2VzcyIsImVudiIsIkNPUlNfT1JJR0lOIiwiY3JlZGVudGlhbHMiLCJwb3J0IiwiUE9SVCIsInNlcnZlciIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IkQ6XFxCdXNfVHJhY2tpbmdcXEZyb250RW5kXFxCVVMtVFJBQ0tJTkdcXEJhY2tFbmRcXHNyY1xcIiwic291cmNlcyI6WyJzZXZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgYm9keVBhcnNlciBmcm9tIFwiYm9keS1wYXJzZXJcIjtcclxuaW1wb3J0IHZpZXdFbmdpbmUgZnJvbSBcIi4vY29uZmlnL3ZpZXdFbmdpbmUuanNcIjtcclxuaW1wb3J0IGluaXRXZWJSb3V0ZXIgZnJvbSBcIi4vcm91dGUvd2ViLmpzXCI7XHJcbmltcG9ydCBpbml0QVBJUm91dGVyIGZyb20gXCIuL3JvdXRlL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBjaGVja0Nvbm5lY3Rpb24gfSBmcm9tIFwiLi9jb25maWcvY29ubmVjdERCLmpzXCI7IC8vIEltcG9ydCBow6BtIGNoZWNrXHJcbmltcG9ydCBjb29raWVQYXJzZXIgZnJvbSBcImNvb2tpZS1wYXJzZXJcIjtcclxuaW1wb3J0IGhlbG1ldCBmcm9tIFwiaGVsbWV0XCI7XHJcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XHJcbmltcG9ydCBjb3JzIGZyb20gXCJjb3JzXCI7XHJcbmltcG9ydCBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXIgfSBmcm9tICdodHRwJzsgLy8g4pyFIFRow6ptIEhUVFAgc2VydmVyXHJcbmltcG9ydCB7IGluaXRXZWJTb2NrZXQgfSBmcm9tIFwiLi9zZXJ2aWNlL1dlYnNvY2tldFNlcnZpY2UuanNcIjsgLy8g4pyFIFRow6ptIFdTXHJcblxyXG5kb3RlbnYuY29uZmlnKCk7XHJcbmF3YWl0IGNoZWNrQ29ubmVjdGlvbigpOyAvLyDinIUgS2nhu4NtIHRyYSBr4bq/dCBu4buRaSBEQiBraGkga2jhu59pIMSR4buZbmdcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuY29uc3QgX19kaXJuYW1lID0gcGF0aC5yZXNvbHZlKCk7XHJcblxyXG5hcHAudXNlKFwiL3B1YmxpY1wiLCBleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcInB1YmxpY1wiKSkpO1xyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbih7IGxpbWl0OiBcIjUwbWJcIiB9KSk7XHJcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUsIGxpbWl0OiBcIjUwbWJcIiB9KSk7XHJcbmFwcC51c2UoXHJcbiAgY29ycyh7XHJcbiAgICBvcmlnaW46IHByb2Nlc3MuZW52LkNPUlNfT1JJR0lOIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo1MTczXCIsXHJcbiAgICBjcmVkZW50aWFsczogdHJ1ZSxcclxuICB9KVxyXG4pO1xyXG5hcHAudXNlKGhlbG1ldCgpKTtcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoY29va2llUGFyc2VyKCkpO1xyXG5cclxudmlld0VuZ2luZShhcHApO1xyXG5cclxuLy8gS2jhu59pIHThuqFvIGPDoWMgUm91dGVyXHJcbmluaXRXZWJSb3V0ZXIoYXBwKTtcclxuaW5pdEFQSVJvdXRlcihhcHApO1xyXG5cclxuLy8g4pyFIEPhuqV1IGjDrG5oIFNlcnZlciAoSFRUUCArIFdlYlNvY2tldClcclxuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgNjk2OTtcclxuY29uc3Qgc2VydmVyID0gY3JlYXRlU2VydmVyKGFwcCk7IC8vIFThuqFvIEhUVFAgc2VydmVyIHThu6sgYXBwIEV4cHJlc3NcclxuXHJcbmluaXRXZWJTb2NrZXQoc2VydmVyKTsgLy8gS2jhu59pIHThuqFvIFdlYlNvY2tldCBTZXJ2ZXJcclxuXHJcbnNlcnZlci5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGDinIUgU2VydmVyIChIVFRQICYgV1MpIMSRYW5nIGNo4bqheSB04bqhaSBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTtcclxufSk7Il0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxPQUFPLE1BQU0sU0FBUztBQUM3QixPQUFPQyxVQUFVLE1BQU0sYUFBYTtBQUNwQyxPQUFPQyxVQUFVLE1BQU0sd0JBQXdCO0FBQy9DLE9BQU9DLGFBQWEsTUFBTSxnQkFBZ0I7QUFDMUMsT0FBT0MsYUFBYSxNQUFNLGdCQUFnQjtBQUMxQyxTQUFTQyxlQUFlLFFBQVEsdUJBQXVCLENBQUMsQ0FBQztBQUN6RCxPQUFPQyxZQUFZLE1BQU0sZUFBZTtBQUN4QyxPQUFPQyxNQUFNLE1BQU0sUUFBUTtBQUMzQixPQUFPQyxJQUFJLE1BQU0sTUFBTTtBQUN2QixPQUFPQyxJQUFJLE1BQU0sTUFBTTtBQUN2QixPQUFPQyxNQUFNLE1BQU0sUUFBUTtBQUMzQixTQUFTQyxZQUFZLFFBQVEsTUFBTSxDQUFDLENBQUM7QUFDckMsU0FBU0MsYUFBYSxRQUFRLCtCQUErQixDQUFDLENBQUM7O0FBRS9ERixNQUFNLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQ2YsTUFBTVIsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUV6QixNQUFNUyxHQUFHLEdBQUdkLE9BQU8sQ0FBQyxDQUFDO0FBQ3JCLE1BQU1lLFNBQVMsR0FBR1AsSUFBSSxDQUFDUSxPQUFPLENBQUMsQ0FBQztBQUVoQ0YsR0FBRyxDQUFDRyxHQUFHLENBQUMsU0FBUyxFQUFFakIsT0FBTyxDQUFDa0IsTUFBTSxDQUFDVixJQUFJLENBQUNXLElBQUksQ0FBQ0osU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDbEVELEdBQUcsQ0FBQ0csR0FBRyxDQUFDaEIsVUFBVSxDQUFDbUIsSUFBSSxDQUFDO0VBQUVDLEtBQUssRUFBRTtBQUFPLENBQUMsQ0FBQyxDQUFDO0FBQzNDUCxHQUFHLENBQUNHLEdBQUcsQ0FBQ2hCLFVBQVUsQ0FBQ3FCLFVBQVUsQ0FBQztFQUFFQyxRQUFRLEVBQUUsSUFBSTtFQUFFRixLQUFLLEVBQUU7QUFBTyxDQUFDLENBQUMsQ0FBQztBQUNqRVAsR0FBRyxDQUFDRyxHQUFHLENBQ0xSLElBQUksQ0FBQztFQUNIZSxNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxXQUFXLElBQUksdUJBQXVCO0VBQzFEQyxXQUFXLEVBQUU7QUFDZixDQUFDLENBQ0gsQ0FBQztBQUNEZCxHQUFHLENBQUNHLEdBQUcsQ0FBQ1YsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqQk8sR0FBRyxDQUFDRyxHQUFHLENBQUNqQixPQUFPLENBQUNvQixJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCTixHQUFHLENBQUNHLEdBQUcsQ0FBQ1gsWUFBWSxDQUFDLENBQUMsQ0FBQztBQUV2QkosVUFBVSxDQUFDWSxHQUFHLENBQUM7O0FBRWY7QUFDQVgsYUFBYSxDQUFDVyxHQUFHLENBQUM7QUFDbEJWLGFBQWEsQ0FBQ1UsR0FBRyxDQUFDOztBQUVsQjtBQUNBLE1BQU1lLElBQUksR0FBR0osT0FBTyxDQUFDQyxHQUFHLENBQUNJLElBQUksSUFBSSxJQUFJO0FBQ3JDLE1BQU1DLE1BQU0sR0FBR3BCLFlBQVksQ0FBQ0csR0FBRyxDQUFDLENBQUMsQ0FBQzs7QUFFbENGLGFBQWEsQ0FBQ21CLE1BQU0sQ0FBQyxDQUFDLENBQUM7O0FBRXZCQSxNQUFNLENBQUNDLE1BQU0sQ0FBQ0gsSUFBSSxFQUFFLE1BQU07RUFDeEJJLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHVEQUF1REwsSUFBSSxFQUFFLENBQUM7QUFDNUUsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","bodyParser","viewEngine","initWebRouter","initAPIRouter","checkConnection","cookieParser","helmet","path","cors","dotenv","createServer","initWebSocket","config","app","__dirname","resolve","use","static","join","json","limit","urlencoded","extended","origin","process","env","CORS_ORIGIN","credentials","port","PORT","server","listen","console","log"],"sourceRoot":"D:\\Bus_Tracking\\FrontEnd\\BUS-TRACKING\\BackEnd\\src\\","sources":["sever.js"],"sourcesContent":["import express from \"express\";\r\nimport bodyParser from \"body-parser\";\r\nimport viewEngine from \"./config/viewEngine.js\";\r\nimport initWebRouter from \"./route/web.js\";\r\nimport initAPIRouter from \"./route/Api.js\";\r\nimport { checkConnection } from \"./config/connectDB.js\"; // Import hàm check\r\nimport cookieParser from \"cookie-parser\";\r\nimport helmet from \"helmet\";\r\nimport path from \"path\";\r\nimport cors from \"cors\";\r\nimport dotenv from \"dotenv\";\r\nimport { createServer } from 'http'; // ✅ Thêm HTTP server\r\nimport { initWebSocket } from \"./service/WebsocketService.js\"; // ✅ Thêm WS\r\n\r\ndotenv.config();\r\nawait checkConnection(); // ✅ Kiểm tra kết nối DB khi khởi động\r\n\r\nconst app = express();\r\nconst __dirname = path.resolve();\r\n\r\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\r\napp.use(bodyParser.json({ limit: \"50mb\" }));\r\napp.use(bodyParser.urlencoded({ extended: true, limit: \"50mb\" }));\r\napp.use(\r\n  cors({\r\n    origin: process.env.CORS_ORIGIN || \"http://localhost:5173\",\r\n    credentials: true,\r\n  })\r\n);\r\napp.use(helmet());\r\napp.use(express.json());\r\napp.use(cookieParser());\r\n\r\nviewEngine(app);\r\n\r\n// Khởi tạo các Router\r\ninitWebRouter(app);\r\ninitAPIRouter(app);\r\n\r\n// ✅ Cấu hình Server (HTTP + WebSocket)\r\nconst port = process.env.PORT || 6969;\r\nconst server = createServer(app); // Tạo HTTP server từ app Express\r\n\r\ninitWebSocket(server); // Khởi tạo WebSocket Server\r\n\r\nserver.listen(port, () => {\r\n  console.log(`✅ Server (HTTP & WS) đang chạy tại http://localhost:${port}`);\r\n});"],"mappings":"AAAA,OAAOA,OAAO,MAAM,SAAS;AAC7B,OAAOC,UAAU,MAAM,aAAa;AACpC,OAAOC,UAAU,MAAM,wBAAwB;AAC/C,OAAOC,aAAa,MAAM,gBAAgB;AAC1C,OAAOC,aAAa,MAAM,gBAAgB;AAC1C,SAASC,eAAe,QAAQ,uBAAuB,CAAC,CAAC;AACzD,OAAOC,YAAY,MAAM,eAAe;AACxC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,QAAQ;AAC3B,SAASC,YAAY,QAAQ,MAAM,CAAC,CAAC;AACrC,SAASC,aAAa,QAAQ,+BAA+B,CAAC,CAAC;;AAE/DF,MAAM,CAACG,MAAM,CAAC,CAAC;AACf,MAAMR,eAAe,CAAC,CAAC,CAAC,CAAC;;AAEzB,MAAMS,GAAG,GAAGd,OAAO,CAAC,CAAC;AACrB,MAAMe,SAAS,GAAGP,IAAI,CAACQ,OAAO,CAAC,CAAC;AAEhCF,GAAG,CAACG,GAAG,CAAC,SAAS,EAAEjB,OAAO,CAACkB,MAAM,CAACV,IAAI,CAACW,IAAI,CAACJ,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AAClED,GAAG,CAACG,GAAG,CAAChB,UAAU,CAACmB,IAAI,CAAC;EAAEC,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AAC3CP,GAAG,CAACG,GAAG,CAAChB,UAAU,CAACqB,UAAU,CAAC;EAAEC,QAAQ,EAAE,IAAI;EAAEF,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AACjEP,GAAG,CAACG,GAAG,CACLR,IAAI,CAAC;EACHe,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,WAAW,IAAI,uBAAuB;EAC1DC,WAAW,EAAE;AACf,CAAC,CACH,CAAC;AACDd,GAAG,CAACG,GAAG,CAACV,MAAM,CAAC,CAAC,CAAC;AACjBO,GAAG,CAACG,GAAG,CAACjB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC;AACvBN,GAAG,CAACG,GAAG,CAACX,YAAY,CAAC,CAAC,CAAC;AAEvBJ,UAAU,CAACY,GAAG,CAAC;;AAEf;AACAX,aAAa,CAACW,GAAG,CAAC;AAClBV,aAAa,CAACU,GAAG,CAAC;;AAElB;AACA,MAAMe,IAAI,GAAGJ,OAAO,CAACC,GAAG,CAACI,IAAI,IAAI,IAAI;AACrC,MAAMC,MAAM,GAAGpB,YAAY,CAACG,GAAG,CAAC,CAAC,CAAC;;AAElCF,aAAa,CAACmB,MAAM,CAAC,CAAC,CAAC;;AAEvBA,MAAM,CAACC,MAAM,CAACH,IAAI,EAAE,MAAM;EACxBI,OAAO,CAACC,GAAG,CAAC,uDAAuDL,IAAI,EAAE,CAAC;AAC5E,CAAC,CAAC","ignoreList":[]}},"mtime":1763356235169},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\Backend\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\Backend\",\"filename\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\Backend\\\\src\\\\sever.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Bus_Tracking\\\\FrontEnd\\\\BUS-TRACKING\\\\Backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.4:development":{"value":{"code":"import express from \"express\";\nimport bodyParser from \"body-parser\";\nimport viewEngine from \"./config/viewEngine.js\";\nimport initWebRouter from \"./route/web.js\";\nimport initAPIRouter from \"./route/Api.js\";\nimport { checkConnection } from \"./config/connectDB.js\"; // Import hàm check\nimport cookieParser from \"cookie-parser\";\nimport helmet from \"helmet\";\nimport path from \"path\";\nimport cors from \"cors\";\nimport dotenv from \"dotenv\";\nimport { createServer } from 'http'; // ✅ Thêm HTTP server\nimport { initWebSocket } from \"./service/WebsocketService.js\"; // ✅ Thêm WS\n\ndotenv.config();\nawait checkConnection(); // ✅ Kiểm tra kết nối DB khi khởi động\n\nconst app = express();\nconst __dirname = path.resolve();\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\napp.use(bodyParser.json({\n  limit: \"50mb\"\n}));\napp.use(bodyParser.urlencoded({\n  extended: true,\n  limit: \"50mb\"\n}));\napp.use(cors({\n  origin: process.env.CORS_ORIGIN || \"http://localhost:5173\",\n  credentials: true\n}));\napp.use(helmet());\napp.use(express.json());\napp.use(cookieParser());\nviewEngine(app);\n\n// Khởi tạo các Router\ninitWebRouter(app);\ninitAPIRouter(app);\n\n// ✅ Cấu hình Server (HTTP + WebSocket)\nconst port = process.env.PORT || 6969;\nconst server = createServer(app); // Tạo HTTP server từ app Express\n\ninitWebSocket(server); // Khởi tạo WebSocket Server\n\nserver.listen(port, () => {\n  console.log(`✅ Server (HTTP & WS) đang chạy tại http://localhost:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwiYm9keVBhcnNlciIsInZpZXdFbmdpbmUiLCJpbml0V2ViUm91dGVyIiwiaW5pdEFQSVJvdXRlciIsImNoZWNrQ29ubmVjdGlvbiIsImNvb2tpZVBhcnNlciIsImhlbG1ldCIsInBhdGgiLCJjb3JzIiwiZG90ZW52IiwiY3JlYXRlU2VydmVyIiwiaW5pdFdlYlNvY2tldCIsImNvbmZpZyIsImFwcCIsIl9fZGlybmFtZSIsInJlc29sdmUiLCJ1c2UiLCJzdGF0aWMiLCJqb2luIiwianNvbiIsImxpbWl0IiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwib3JpZ2luIiwicHJvY2VzcyIsImVudiIsIkNPUlNfT1JJR0lOIiwiY3JlZGVudGlhbHMiLCJwb3J0IiwiUE9SVCIsInNlcnZlciIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IkQ6XFxCdXNfVHJhY2tpbmdcXEZyb250RW5kXFxCVVMtVFJBQ0tJTkdcXEJhY2tlbmRcXHNyY1xcIiwic291cmNlcyI6WyJzZXZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgYm9keVBhcnNlciBmcm9tIFwiYm9keS1wYXJzZXJcIjtcclxuaW1wb3J0IHZpZXdFbmdpbmUgZnJvbSBcIi4vY29uZmlnL3ZpZXdFbmdpbmUuanNcIjtcclxuaW1wb3J0IGluaXRXZWJSb3V0ZXIgZnJvbSBcIi4vcm91dGUvd2ViLmpzXCI7XHJcbmltcG9ydCBpbml0QVBJUm91dGVyIGZyb20gXCIuL3JvdXRlL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBjaGVja0Nvbm5lY3Rpb24gfSBmcm9tIFwiLi9jb25maWcvY29ubmVjdERCLmpzXCI7IC8vIEltcG9ydCBow6BtIGNoZWNrXHJcbmltcG9ydCBjb29raWVQYXJzZXIgZnJvbSBcImNvb2tpZS1wYXJzZXJcIjtcclxuaW1wb3J0IGhlbG1ldCBmcm9tIFwiaGVsbWV0XCI7XHJcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XHJcbmltcG9ydCBjb3JzIGZyb20gXCJjb3JzXCI7XHJcbmltcG9ydCBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXIgfSBmcm9tICdodHRwJzsgLy8g4pyFIFRow6ptIEhUVFAgc2VydmVyXHJcbmltcG9ydCB7IGluaXRXZWJTb2NrZXQgfSBmcm9tIFwiLi9zZXJ2aWNlL1dlYnNvY2tldFNlcnZpY2UuanNcIjsgLy8g4pyFIFRow6ptIFdTXHJcblxyXG5kb3RlbnYuY29uZmlnKCk7XHJcbmF3YWl0IGNoZWNrQ29ubmVjdGlvbigpOyAvLyDinIUgS2nhu4NtIHRyYSBr4bq/dCBu4buRaSBEQiBraGkga2jhu59pIMSR4buZbmdcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuY29uc3QgX19kaXJuYW1lID0gcGF0aC5yZXNvbHZlKCk7XHJcblxyXG5hcHAudXNlKFwiL3B1YmxpY1wiLCBleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcInB1YmxpY1wiKSkpO1xyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbih7IGxpbWl0OiBcIjUwbWJcIiB9KSk7XHJcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUsIGxpbWl0OiBcIjUwbWJcIiB9KSk7XHJcbmFwcC51c2UoXHJcbiAgY29ycyh7XHJcbiAgICBvcmlnaW46IHByb2Nlc3MuZW52LkNPUlNfT1JJR0lOIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo1MTczXCIsXHJcbiAgICBjcmVkZW50aWFsczogdHJ1ZSxcclxuICB9KVxyXG4pO1xyXG5hcHAudXNlKGhlbG1ldCgpKTtcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoY29va2llUGFyc2VyKCkpO1xyXG5cclxudmlld0VuZ2luZShhcHApO1xyXG5cclxuLy8gS2jhu59pIHThuqFvIGPDoWMgUm91dGVyXHJcbmluaXRXZWJSb3V0ZXIoYXBwKTtcclxuaW5pdEFQSVJvdXRlcihhcHApO1xyXG5cclxuLy8g4pyFIEPhuqV1IGjDrG5oIFNlcnZlciAoSFRUUCArIFdlYlNvY2tldClcclxuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgNjk2OTtcclxuY29uc3Qgc2VydmVyID0gY3JlYXRlU2VydmVyKGFwcCk7IC8vIFThuqFvIEhUVFAgc2VydmVyIHThu6sgYXBwIEV4cHJlc3NcclxuXHJcbmluaXRXZWJTb2NrZXQoc2VydmVyKTsgLy8gS2jhu59pIHThuqFvIFdlYlNvY2tldCBTZXJ2ZXJcclxuXHJcbnNlcnZlci5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGDinIUgU2VydmVyIChIVFRQICYgV1MpIMSRYW5nIGNo4bqheSB04bqhaSBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTtcclxufSk7Il0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxPQUFPLE1BQU0sU0FBUztBQUM3QixPQUFPQyxVQUFVLE1BQU0sYUFBYTtBQUNwQyxPQUFPQyxVQUFVLE1BQU0sd0JBQXdCO0FBQy9DLE9BQU9DLGFBQWEsTUFBTSxnQkFBZ0I7QUFDMUMsT0FBT0MsYUFBYSxNQUFNLGdCQUFnQjtBQUMxQyxTQUFTQyxlQUFlLFFBQVEsdUJBQXVCLENBQUMsQ0FBQztBQUN6RCxPQUFPQyxZQUFZLE1BQU0sZUFBZTtBQUN4QyxPQUFPQyxNQUFNLE1BQU0sUUFBUTtBQUMzQixPQUFPQyxJQUFJLE1BQU0sTUFBTTtBQUN2QixPQUFPQyxJQUFJLE1BQU0sTUFBTTtBQUN2QixPQUFPQyxNQUFNLE1BQU0sUUFBUTtBQUMzQixTQUFTQyxZQUFZLFFBQVEsTUFBTSxDQUFDLENBQUM7QUFDckMsU0FBU0MsYUFBYSxRQUFRLCtCQUErQixDQUFDLENBQUM7O0FBRS9ERixNQUFNLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQ2YsTUFBTVIsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUV6QixNQUFNUyxHQUFHLEdBQUdkLE9BQU8sQ0FBQyxDQUFDO0FBQ3JCLE1BQU1lLFNBQVMsR0FBR1AsSUFBSSxDQUFDUSxPQUFPLENBQUMsQ0FBQztBQUVoQ0YsR0FBRyxDQUFDRyxHQUFHLENBQUMsU0FBUyxFQUFFakIsT0FBTyxDQUFDa0IsTUFBTSxDQUFDVixJQUFJLENBQUNXLElBQUksQ0FBQ0osU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDbEVELEdBQUcsQ0FBQ0csR0FBRyxDQUFDaEIsVUFBVSxDQUFDbUIsSUFBSSxDQUFDO0VBQUVDLEtBQUssRUFBRTtBQUFPLENBQUMsQ0FBQyxDQUFDO0FBQzNDUCxHQUFHLENBQUNHLEdBQUcsQ0FBQ2hCLFVBQVUsQ0FBQ3FCLFVBQVUsQ0FBQztFQUFFQyxRQUFRLEVBQUUsSUFBSTtFQUFFRixLQUFLLEVBQUU7QUFBTyxDQUFDLENBQUMsQ0FBQztBQUNqRVAsR0FBRyxDQUFDRyxHQUFHLENBQ0xSLElBQUksQ0FBQztFQUNIZSxNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxXQUFXLElBQUksdUJBQXVCO0VBQzFEQyxXQUFXLEVBQUU7QUFDZixDQUFDLENBQ0gsQ0FBQztBQUNEZCxHQUFHLENBQUNHLEdBQUcsQ0FBQ1YsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqQk8sR0FBRyxDQUFDRyxHQUFHLENBQUNqQixPQUFPLENBQUNvQixJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCTixHQUFHLENBQUNHLEdBQUcsQ0FBQ1gsWUFBWSxDQUFDLENBQUMsQ0FBQztBQUV2QkosVUFBVSxDQUFDWSxHQUFHLENBQUM7O0FBRWY7QUFDQVgsYUFBYSxDQUFDVyxHQUFHLENBQUM7QUFDbEJWLGFBQWEsQ0FBQ1UsR0FBRyxDQUFDOztBQUVsQjtBQUNBLE1BQU1lLElBQUksR0FBR0osT0FBTyxDQUFDQyxHQUFHLENBQUNJLElBQUksSUFBSSxJQUFJO0FBQ3JDLE1BQU1DLE1BQU0sR0FBR3BCLFlBQVksQ0FBQ0csR0FBRyxDQUFDLENBQUMsQ0FBQzs7QUFFbENGLGFBQWEsQ0FBQ21CLE1BQU0sQ0FBQyxDQUFDLENBQUM7O0FBRXZCQSxNQUFNLENBQUNDLE1BQU0sQ0FBQ0gsSUFBSSxFQUFFLE1BQU07RUFDeEJJLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHVEQUF1REwsSUFBSSxFQUFFLENBQUM7QUFDNUUsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","bodyParser","viewEngine","initWebRouter","initAPIRouter","checkConnection","cookieParser","helmet","path","cors","dotenv","createServer","initWebSocket","config","app","__dirname","resolve","use","static","join","json","limit","urlencoded","extended","origin","process","env","CORS_ORIGIN","credentials","port","PORT","server","listen","console","log"],"sourceRoot":"D:\\Bus_Tracking\\FrontEnd\\BUS-TRACKING\\Backend\\src\\","sources":["sever.js"],"sourcesContent":["import express from \"express\";\r\nimport bodyParser from \"body-parser\";\r\nimport viewEngine from \"./config/viewEngine.js\";\r\nimport initWebRouter from \"./route/web.js\";\r\nimport initAPIRouter from \"./route/Api.js\";\r\nimport { checkConnection } from \"./config/connectDB.js\"; // Import hàm check\r\nimport cookieParser from \"cookie-parser\";\r\nimport helmet from \"helmet\";\r\nimport path from \"path\";\r\nimport cors from \"cors\";\r\nimport dotenv from \"dotenv\";\r\nimport { createServer } from 'http'; // ✅ Thêm HTTP server\r\nimport { initWebSocket } from \"./service/WebsocketService.js\"; // ✅ Thêm WS\r\n\r\ndotenv.config();\r\nawait checkConnection(); // ✅ Kiểm tra kết nối DB khi khởi động\r\n\r\nconst app = express();\r\nconst __dirname = path.resolve();\r\n\r\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\r\napp.use(bodyParser.json({ limit: \"50mb\" }));\r\napp.use(bodyParser.urlencoded({ extended: true, limit: \"50mb\" }));\r\napp.use(\r\n  cors({\r\n    origin: process.env.CORS_ORIGIN || \"http://localhost:5173\",\r\n    credentials: true,\r\n  })\r\n);\r\napp.use(helmet());\r\napp.use(express.json());\r\napp.use(cookieParser());\r\n\r\nviewEngine(app);\r\n\r\n// Khởi tạo các Router\r\ninitWebRouter(app);\r\ninitAPIRouter(app);\r\n\r\n// ✅ Cấu hình Server (HTTP + WebSocket)\r\nconst port = process.env.PORT || 6969;\r\nconst server = createServer(app); // Tạo HTTP server từ app Express\r\n\r\ninitWebSocket(server); // Khởi tạo WebSocket Server\r\n\r\nserver.listen(port, () => {\r\n  console.log(`✅ Server (HTTP & WS) đang chạy tại http://localhost:${port}`);\r\n});"],"mappings":"AAAA,OAAOA,OAAO,MAAM,SAAS;AAC7B,OAAOC,UAAU,MAAM,aAAa;AACpC,OAAOC,UAAU,MAAM,wBAAwB;AAC/C,OAAOC,aAAa,MAAM,gBAAgB;AAC1C,OAAOC,aAAa,MAAM,gBAAgB;AAC1C,SAASC,eAAe,QAAQ,uBAAuB,CAAC,CAAC;AACzD,OAAOC,YAAY,MAAM,eAAe;AACxC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,QAAQ;AAC3B,SAASC,YAAY,QAAQ,MAAM,CAAC,CAAC;AACrC,SAASC,aAAa,QAAQ,+BAA+B,CAAC,CAAC;;AAE/DF,MAAM,CAACG,MAAM,CAAC,CAAC;AACf,MAAMR,eAAe,CAAC,CAAC,CAAC,CAAC;;AAEzB,MAAMS,GAAG,GAAGd,OAAO,CAAC,CAAC;AACrB,MAAMe,SAAS,GAAGP,IAAI,CAACQ,OAAO,CAAC,CAAC;AAEhCF,GAAG,CAACG,GAAG,CAAC,SAAS,EAAEjB,OAAO,CAACkB,MAAM,CAACV,IAAI,CAACW,IAAI,CAACJ,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AAClED,GAAG,CAACG,GAAG,CAAChB,UAAU,CAACmB,IAAI,CAAC;EAAEC,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AAC3CP,GAAG,CAACG,GAAG,CAAChB,UAAU,CAACqB,UAAU,CAAC;EAAEC,QAAQ,EAAE,IAAI;EAAEF,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AACjEP,GAAG,CAACG,GAAG,CACLR,IAAI,CAAC;EACHe,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,WAAW,IAAI,uBAAuB;EAC1DC,WAAW,EAAE;AACf,CAAC,CACH,CAAC;AACDd,GAAG,CAACG,GAAG,CAACV,MAAM,CAAC,CAAC,CAAC;AACjBO,GAAG,CAACG,GAAG,CAACjB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC;AACvBN,GAAG,CAACG,GAAG,CAACX,YAAY,CAAC,CAAC,CAAC;AAEvBJ,UAAU,CAACY,GAAG,CAAC;;AAEf;AACAX,aAAa,CAACW,GAAG,CAAC;AAClBV,aAAa,CAACU,GAAG,CAAC;;AAElB;AACA,MAAMe,IAAI,GAAGJ,OAAO,CAACC,GAAG,CAACI,IAAI,IAAI,IAAI;AACrC,MAAMC,MAAM,GAAGpB,YAAY,CAACG,GAAG,CAAC,CAAC,CAAC;;AAElCF,aAAa,CAACmB,MAAM,CAAC,CAAC,CAAC;;AAEvBA,MAAM,CAACC,MAAM,CAACH,IAAI,EAAE,MAAM;EACxBI,OAAO,CAACC,GAAG,CAAC,uDAAuDL,IAAI,EAAE,CAAC;AAC5E,CAAC,CAAC","ignoreList":[]}},"mtime":1763356235169}}